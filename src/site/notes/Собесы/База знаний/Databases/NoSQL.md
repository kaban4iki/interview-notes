---
{"dg-publish":true,"permalink":"/sobesy/baza-znanij/databases/no-sql/"}
---

## Что такое NoSQL и зачем они нужны

**Кратко:**  
NoSQL — это класс баз данных, которые не придерживаются реляционной модели и SQL как основного интерфейса. Они оптимизированы под масштабирование, высокую доступность и работу с конкретными моделями данных. NoSQL почти всегда жертвуют частью строгой согласованности или универсальности ради производительности и простоты масштабирования.

Основные причины использования:
- горизонтальное масштабирование (sharding)
- высокая write/read нагрузка
- гибкая схема или её отсутствие
- специфические паттерны доступа к данным

**Типовой вопрос:**  
Когда NoSQL оправдан, а когда это ошибка?

**Ответ:**  
NoSQL оправдан, когда:
- модель данных плохо ложится в таблицы
- важнее latency и throughput, чем строгие транзакции
- данные распределены по кластерам

---

## CAP теорема и NoSQL

**Кратко:**  
CAP теорема описывает компромисс между:
- **Consistency** — все клиенты видят одинаковые данные
- **Availability** — система отвечает на каждый запрос
- **Partition tolerance** — система работает при сетевых разделениях

В распределённых системах всегда выбирают только два из трёх.

**Типовой вопрос:**  
Как CAP влияет на дизайн NoSQL систем?

**Ответ:**  
На практике:
- Partition tolerance считается обязательной
- выбор идёт между Consistency и Availability

Примеры:
- Cassandra — AP (eventual consistency)
- MongoDB — CP (primary + replicas)
- Redis Cluster — AP с ограничениями

---

## Key-Value Stores (Redis, DynamoDB)

**Кратко:**  
Key-Value БД хранят данные как пару `ключ → значение`.  
Они оптимизированы под:
- быстрый доступ по ключу
- простые операции
- минимальную latency

**Типовой вопрос:**  
Почему key-value плохо подходят для сложных запросов?

**Ответ:**  
Потому что:
- нет secondary indexes (или они ограничены)
- нет join-ов
- запросы не декларативны

Используются для:
- кэшей
- сессий
- rate limiting
- feature flags

---

## Document Stores (MongoDB)

**Кратко:**  
Document-oriented БД хранят данные в виде документов (JSON/BSON).  
Поддерживают:
- вложенные структуры
- secondary indexes
- агрегации

**Типовой вопрос:**  
В чём основная проблема document БД?

**Ответ:**  
Основные сложности:
- дублирование данных
- отсутствие join-ов как в SQL
- сложность поддержки консистентности

Подходят для:
- profile-based данных
- event storage
- API-oriented моделей

---

## Wide-Column Stores (Cassandra)

**Кратко:**  
Wide-column БД хранят данные по ключу партиции и сортированным колонкам.  
Модель ориентирована на заранее известные запросы.

**Типовой вопрос:**  
Почему Cassandra требует проектирования от запросов?

**Ответ:**  
Потому что:
- нет ad-hoc запросов
- структура таблицы диктуется паттернами чтения
- изменение запросов = изменение схемы

Используется в:
- time-series
- logging
- high-throughput системах

---

## Graph Databases (Neo4j)

**Кратко:**  
Graph БД хранят данные как вершины и рёбра.  
Оптимизированы под:
- обход графов
- сложные связи
- рекомендации

**Типовой вопрос:**  
Почему graph БД плохо масштабируются?

**Ответ:**  
Потому что:
- traversal требует локальности данных
- сложно шардировать граф
- высокая связность данных

---

## Сравнение NoSQL баз данных

**Кратко:**  
NoSQL базы данных отличаются моделью хранения, гарантиями согласованности и типичными сценариями использования. Универсального варианта не существует — каждая категория решает свой класс задач.

**Типовой вопрос:**  
Как быстро понять, какой тип NoSQL базы подходит под задачу?

**Ответ:**  
Нужно смотреть на:
- модель данных
- характер запросов
- требования к согласованности
- масштабируемость

### Сравнительная таблица NoSQL

|Тип БД|Примеры|Модель данных|Сильные стороны|Ограничения|Типичные кейсы|
|---|---|---|---|---|---|
|**Key-Value**|Redis, DynamoDB|ключ → значение|минимальная задержка, простота|нет сложных запросов|кэш, сессии|
|**Document**|MongoDB|JSON-документы|гибкая схема, индексы|дублирование данных|профили, API|
|**Wide-Column**|Cassandra|партиция + колонки|высокая запись, масштаб|запросы жёстко заданы|логи, метрики|
|**Graph**|Neo4j|вершины и рёбра|сложные связи|сложный шардинг|рекомендации|